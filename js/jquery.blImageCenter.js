(function($){$.fn.centerImage=function(method,callback){callback=callback||function(){};var els=this;var remaining=$(this).length;method=method=='inside';var fn=function(img){var $img=$(img);var $div=$img.parent();$div.css({overflow:'hidden',position:$div.css('position')=='absolute'?'absolute':'relative'});$img.css({'position':'static','width':'auto','height':'auto','max-width':'100%','max-height':'100%'});var div={w:$div.width(),h:$div.height(),r:$div.width()/$div.height()};var img={w:$img.width(),h:$img.height(),r:$img.width()/$img.height()};$img.css({'max-width':'none','max-height':'none','width':Math.round((div.r>img.r)^method?'100%':div.h/img.h*img.w),'height':Math.round((div.r<img.r)^method?'100%':div.w/img.w*img.h)});var div={w:$div.width(),h:$div.height()};var img={w:$img.width(),h:$img.height()};$img.css({'position':'absolute','left':Math.round((div.w-img.w)/2),'top':Math.round((div.h-img.h)/3)});callbackWrapped(img)};var callbackWrapped=function(img){remaining--;callback.apply(els,[img,remaining]);};return els.each(function(i){if(this.complete||this.readyState==='complete'){(function(el){setTimeout(function(){fn(el)},1);})(this);}else{(function(el){$(el).one('load',function(){setTimeout(function(){fn(el);},1);}).one('error',function(){callbackWrapped(el)}).end();if(navigator.userAgent.indexOf("Trident/5")>=0||navigator.userAgent.indexOf("Trident/6")){el.src=el.src;}})(this);}});};$.fn.imageCenterResize=function(callback){return $(this).centerImage('inside',callback);};$.fn.imageCropFill=function(callback){return $(this).centerImage('outside',callback);};})(jQuery);